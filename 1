from selenium import webdriver
import  time
import xlrd, xlwt
from xlutils.copy import copy as xlcopy
rb = xlrd.open_workbook('seb.xls')
sheet = rb.sheet_by_index(0)
write_book = xlcopy(rb)
write_sheet = write_book.get_sheet(0)
driver = webdriver.Chrome('C:/Users/skoro/Downloads/chromedriver_win32 (1)/chromedriver.exe')
driver.maximize_window()
driver.get("https://auth.mephi.ru/login?service=https%3A%2F%2Fhome.mephi.ru%2Fhome")
s_username = driver.find_element_by_id("username")
s_username.clear()
s_username.send_keys("sda052")
s_password = driver.find_element_by_id('password')
s_password.clear()
s_password.send_keys("vfvf2014")
s_continue = driver.find_element_by_css_selector('#login-form > div.form-actions > button')
s_continue.click()
time.sleep(1)
s_c = driver.find_element_by_css_selector('#sidebar-wrapper > ul > li:nth-child(9) > a')
s_c.click()
time.sleep(1)
s_co = driver.find_element_by_css_selector('#page-content-wrapper > div > div > ul.nav.nav-tabs.btn-toolbar > li:nth-child(3) > a')
s_co.click()
time.sleep(1)
s_cor = driver.find_element_by_css_selector('#page-content-wrapper > div > div > div.row > div:nth-child(1) > div > a:nth-child(7)')
s_cor.click()
time.sleep(10)
s_cort = driver.find_element_by_css_selector('#page-content-wrapper > div > div:nth-child(5) > a:nth-child(2)')
s_cort.click()
time.sleep(10)
rows = driver.find_element_by_css_selector('#page-content-wrapper > div > h1')
print(rows.text)
for num in range(1,28):
    s="#page-content-wrapper > div > div.list-group > div:nth-child("+str(num)+") > a"
    row = driver.find_element_by_css_selector(s)
    write_sheet.write(num, 0, row.text)
    write_sheet.write(num, 2, rows.text)
    print(row.text)
write_book.save('seb.xls')
driver.close()
